#!/usr/bin/env python
# -*- coding: utf-8 -*-

from iBrewFolders import AppFolders

from smarter.SmarterProtocol import *
from smarter.SmarterInterface import *

import sys

from  ConfigParser import *

#------------------------------------------------------
# iBrew: iKettle Interface
#
# Legacy Edtion
#
# https://github.com/Tristan79/iBrew
#
# Copyright © 2016-2017 Tristan (@monkeycat.nl). All Rights Reserved
#
# The conundrum struggle
#------------------------------------------------------

def app_info():
    print "iBrew: Legacy iKettle Interface"
    print "iBrew: The conundrum struggle © 2016-2017 Tristan (@monkeycat.nl). All Rights Reserved"
    print
    print "Please DONATE! Food, jokes, hugs and fun toys! To someone who deserves it!\n\nContribute any discoveries on https://github.com/Tristan79/iBrew/issues\n\nThis is untested code. Please report your findings!!! "
    print

def usage():
        print
        print "Usage: ibrewlegacy command host"
        print
        print "Commands"
        print "    heat  " + SmarterLegacy.textHeat
        print "    stop  " + SmarterLegacy.textStop
        print "      65  " + SmarterLegacy.text65c
        print "      80  " + SmarterLegacy.text80c
        print "      95  " + SmarterLegacy.text95c
        print "     100  " + SmarterLegacy.text100c
        print "    warm  " + SmarterLegacy.textWarm
        print "       5  " + SmarterLegacy.textWarm5m
        print "      10  " + SmarterLegacy.textWarm10m
        print "      20  " + SmarterLegacy.textWarm20m
        print "  status  " + SmarterLegacy.textStatus
        print 
        print "    host  ip or host address of the iKettle"
        print

try:
    action = str(sys.argv[1])
    ip = str(sys.argv[2])
except IndexError:
    app_info()
    usage()
    sys.exit(2);
else:
    client = SmarterClientLegacy(ip)
    client.dump = True
    try:
        r = client.send(SmarterLegacy.string_to_command(action))
        for i in r:
            print "iBrew Legacy: " + SmarterLegacy.string_status(i)
    except Exception, e:
        print "iBrew Legacy: Failed with " + str(e)
        sys.exit(3);
